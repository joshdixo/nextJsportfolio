name: Run Cypress ðŸŒ²
  uses: cypress-io/github-action@v5
  env:
    CYPRESS_BASE_URL: ${{ github.event.deployment_status.target_url }}

name: Cypress tests âœ…
  if: ${{ success() }}
  run: |
    curl --request POST \
    --url https://api.github.com/repos/${{ github.repository }}/statuses/${{ github.sha }} \
    --header 'authorization: Bearer ${{ secrets.GITHUB_TOKEN }}' \
    --header 'content-type: application/json' \
    --data '{
      "context": "e2e",
      "state": "success",
      "description": "Cypress tests passed"
    }'

name: Cypress tests ðŸš¨
  if: ${{ failure() }}
  run: |
    curl --request POST \
    --url https://api.github.com/repos/${{ github.repository }}/statuses/${{ github.sha }} \
    --header 'authorization: Bearer ${{ secrets.GITHUB_TOKEN }}' \
    --header 'content-type: application/json' \
    --data '{
      "context": "e2e",
      "state": "failure",
      "description": "Cypress tests failed"
    }'
